INSERT INTO DATA_VAULT.CORE.HUB_STUDYLINK_APPLICANT (HUB_STUDYLINK_APPLICANT_KEY, STUDENT_ID, SOURCE, LOAD_DTS,
                                                       ETL_JOB_ID)
SELECT MD5(A.STUDENT_ID)                      HUB_STUDYLINK_APPLICANT_KEY,
       STUDENT_ID                             STUDENT_ID,
       'STUDYLINK'                               SOURCE,
       CURRENT_TIMESTAMP::timestamp_ntz          LOAD_DTS,
       'SQL' || CURRENT_TIMESTAMP::TIMESTAMP_NTZ ETL_JOB_ID
FROM (
             SELECT DISTINCT DF_APPLICATIONDETAILS_PORTALPROVIDERAPPLICANTID STUDENT_ID
         FROM ODS.STUDYLINK.STUDYLINK_APPLICATION_API_LATEST
         WHERE DF_APPLICATIONDETAILS_PORTALPROVIDERAPPLICANTID IS NOT NULL
     ) A
WHERE NOT EXISTS(
        SELECT 1
        FROM DATA_VAULT.CORE.HUB_STUDYLINK_APPLICANT S
        WHERE S.HUB_STUDYLINK_APPLICANT_KEY = MD5(A.STUDENT_ID)
    );
